const { VueLoaderPlugin } = require('vue-loader')

const glob = require('glob');
const path = require('path')
const chalk = require('chalk');


const list = {};

async function makeList(dirPath, list) {
    const files = glob.sync(`${dirPath}/**/index.js`);

    for (let file of files) {
        const component = file.split(/[/.]/)[2];
        list[component] = `./${file}`
    }

}
makeList('components/lib', list)
const log = console.log;
log(chalk.keyword('orange')('CIIC-UI Build'));
log(chalk.hex('#DEADED').bold('仅限本公司使用,违者必究！'));
log(chalk.hex('#DEADED').bold(`
#################################################
####################,,:###########################
###################:,,,D##########################
###################,,,,,##########################
###################,,,,###;,,#####################
####################:,###E,,,,####################
#########################,,,,,####################
##########f,,,,,,##:,,,##G,,,,########;,,,,,,#####
########:,,,,,,,,##,,,,###,,,#######,,,,,,,,,#####
#######,,,,,,,,,,##,,,,############,,,,,,,,,,#####
######,,,,,,,,,,,##,,,,###,,,D####,,,,,,,,,,,#####
#####:,,,,,,,,,,:##,,,,###,,,,###,,,,,,,,,,,f#####
#####,,,,,#########,,,,###,,,,###,,,,,############
####:,,,,##########,,,,###,,,,##,,,,,#############
####,,,,,##########,,,,###,,,,##,,,,;#############
####,,,,###########,,,,###,,,,##,,,,##############
####,,,,###########,,,,###,,,,##,,,,##############
####,,,,,##########,,,,###,,,,##,,,,,#############
####,,,,,##########,,,,###,,,,##,,,,,#############
#####,,,,,#########,,,,###,,,,###,,,,,############
#####,,,,,,,,,,,,##,,,,###,,,,###,,,,,,,,,,:;#####
######,,,,,,,,,,,##,,,,###,,,,####,,,,,,,,,,,#####
#######,,,,,,,,,,##,,,,###,,,,#####,,,,,,,,,,#####
########:,,,,,,,,##,,,,###,,,,######,,,,,,,,,#####
###########i,,,,i##E,,,###,,,,#########;,,,,D#####
##########################,,,,####################
##########################,,,;####################
`));
module.exports = {
    // lintOnSave: false,
    entry: list,
    mode: 'development',
    output: {
        filename: '[name].umd.js',
        path: path.resolve(__dirname, 'dist'),
        library: 'mui',
        libraryTarget: 'umd'
    },
    plugins: [
        new VueLoaderPlugin()
    ],
    module: {
        rules: [
            {
                test: /\.vue$/,
                use: [
                    {
                        loader: 'vue-loader'
                    }
                ]
            }
        ]
    },
    resolve: {
        alias: {
            '@ciic-ui': path.join(__dirname, './components'),
        },
    },
}